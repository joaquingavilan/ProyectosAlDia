{% extends request.base_template %}
{% block css %}
<style>
  .table-sm th, .table-sm td {
    padding: .3rem; /* Reduce el padding en los th y td para un efecto más comprimido */
  }

  .table-sm {
    font-size: 0.875rem; /* Reduce la fuente para una tabla más compacta */
  }
</style>
{% endblock %}
{% block content %}
<div class="x_panel">
  <div class="x_title">
    <h2>Presupuesto</h2>
    <div class="clearfix"></div>
  </div>

  <div class="x_content">
    <table class="table table-hover table-sm"> <!-- Modificación aquí -->
      <thead>
        <tr>
          <th>Sección</th>
          <th>Subsección</th>
          <th>Rubro</th>
          <th>Unidad Medida</th>
          <th>Cantidad</th>
          <th>Precio Unitario</th>
          <th>Precio Total</th>
        </tr>
      </thead>
      <tbody>
        {% for seccion, subsecciones in estructura_presupuesto %}
          <!-- Sección -->
          <tr class="seccion-row" data-tipo="seccion" data-id="{{ seccion.id }}">
            <td>{{ seccion.nombre }}</td>
            <td colspan="6"></td> <!-- Colspan para cubrir el resto de las columnas -->
          </tr>

          {% for subseccion, detalles in subsecciones %}
            <!-- Subsección -->
            <tr class="subseccion-row" data-tipo="subseccion" data-id="{{ subseccion.id }}" data-seccion-id="{{ seccion.id }}">
              <td></td> <!-- Columna vacía para alinear con la sección padre -->
              <td>{{ subseccion.nombre }}</td>
              <td colspan="5"></td> <!-- Colspan para cubrir el resto de las columnas -->
            </tr>

            {% for detalle in detalles %}
              <!-- Detalle -->
              <tr class="detalle-row" data-tipo="detalle" data-id="{{ detalle.id }}" data-subseccion-id="{{ subseccion.id }}">
                <td></td> <!-- Columna vacía para alinear con la sección y subsección padre -->
                <td></td> <!-- Columna vacía para alinear con la subsección padre -->
                <td>{{ detalle.rubro }}</td>
                <td>{{ detalle.unidad_medida.nombre }}</td>
                <td>{{ detalle.cantidad }}</td>
                <td>{{ detalle.precio_unitario }}</td>
                <td>{{ detalle.precio_total }}</td>
              </tr>
            {% endfor %}
          {% endfor %}
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
